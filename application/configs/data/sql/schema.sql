use edeco;

CREATE TABLE address (id INT, streetandnumber VARCHAR(45) NOT NULL, neighborhood VARCHAR(45) NOT NULL, zipcode VARCHAR(45), addressreference VARCHAR(45), latitude FLOAT(18, 2), longitude FLOAT(18, 2), cityid INT NOT NULL, version BIGINT UNSIGNED DEFAULT '1' NOT NULL, INDEX cityid_idx (cityid), PRIMARY KEY(id)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE category (id INT AUTO_INCREMENT, name VARCHAR(45) NOT NULL, url VARCHAR(45) NOT NULL, version BIGINT UNSIGNED NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE city (id INT AUTO_INCREMENT, name VARCHAR(45) NOT NULL, url VARCHAR(45) NOT NULL, stateid INT NOT NULL, INDEX stateid_idx (stateid), PRIMARY KEY(id)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE map (id INT, top INT UNSIGNED NOT NULL, `left` INT UNSIGNED NOT NULL, `width` FLOAT(18, 2) NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE permission (name VARCHAR(45), rolename VARCHAR(15), resourcename VARCHAR(15), PRIMARY KEY(name, rolename, resourcename)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE picture (id INT AUTO_INCREMENT, shortdescription VARCHAR(80) NOT NULL, filename VARCHAR(100) NOT NULL, propertyid INT NOT NULL, version BIGINT UNSIGNED DEFAULT '1' NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE project (id INT AUTO_INCREMENT, name VARCHAR(120) NOT NULL, attachment VARCHAR(120) NOT NULL, version BIGINT UNSIGNED DEFAULT '1' NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE property (id INT AUTO_INCREMENT, name VARCHAR(45) NOT NULL, url VARCHAR(55) NOT NULL, description TEXT NOT NULL, price TEXT, totalsurface FLOAT(18, 2) NOT NULL, metersoffered FLOAT(18, 2) NOT NULL, metersfront FLOAT(18, 2) NOT NULL, landuse ENUM('housing', 'commercial', 'industrial', 'mixed') NOT NULL, creationdate DATE NOT NULL, availabilityfor ENUM('rent', 'sale') NOT NULL, showonweb TINYINT DEFAULT 0 NOT NULL, contactname VARCHAR(100), contactphone VARCHAR(10), contactcellphone VARCHAR(13), categoryid INT NOT NULL, version BIGINT UNSIGNED DEFAULT '1' NOT NULL, INDEX categoryid_idx (categoryid), PRIMARY KEY(id)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE recommended_property (propertyid INT, recommendedpropertyid INT, PRIMARY KEY(propertyid, recommendedpropertyid)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE resource (name VARCHAR(15), PRIMARY KEY(name)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE role (name VARCHAR(15), parentrole VARCHAR(15) DEFAULT NULL, PRIMARY KEY(name)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE state (id INT AUTO_INCREMENT, name VARCHAR(45) NOT NULL, url VARCHAR(45) NOT NULL, PRIMARY KEY(id)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
CREATE TABLE user (username VARCHAR(120), password VARCHAR(64), state ENUM('active', 'unconfirmed', 'inactive', 'banned') DEFAULT 'active' NOT NULL, rolename VARCHAR(15) NOT NULL, confirmationkey VARCHAR(64), creationdate DATE, INDEX rolename_idx (rolename), PRIMARY KEY(username)) DEFAULT CHARACTER SET UTF8 ENGINE = INNODB;
ALTER TABLE address ADD CONSTRAINT address_cityid_city_id FOREIGN KEY (cityid) REFERENCES city(id);
ALTER TABLE city ADD CONSTRAINT city_stateid_state_id FOREIGN KEY (stateid) REFERENCES state(id);
ALTER TABLE property ADD CONSTRAINT property_categoryid_category_id FOREIGN KEY (categoryid) REFERENCES category(id);
ALTER TABLE recommended_property ADD CONSTRAINT recommended_property_recommendedpropertyid_property_id FOREIGN KEY (recommendedpropertyid) REFERENCES property(id);
ALTER TABLE recommended_property ADD CONSTRAINT recommended_property_propertyid_property_id FOREIGN KEY (propertyid) REFERENCES property(id);
ALTER TABLE user ADD CONSTRAINT user_rolename_role_name FOREIGN KEY (rolename) REFERENCES role(name);
